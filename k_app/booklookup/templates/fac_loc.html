{% extends 'base.html' %}

{%block content%}

<style>
    .rectangle {
        height: 200px;
        width: 700px;
        background-color: aliceblue;
        border-style: double;
    }

    .grid-container {
        display: grid;
        grid-template-areas: "button1 button2"
                                "button3 button4";
        grid-gap: 5px;
    }

    .grid-item:nth-child(1){
        grid-area: button1;
    }

    .grid-item:nth-child(2){
        grid-area: button2;
    }

    .grid-item:nth-child(3){
        grid-area: button3;
    }

    .grid-item:nth-child(4){
        grid-area: button4;
    }
    
    .button {
        width: 100%;
        height: 50px;
        background-color: cornflowerblue;
    }
    
</style>

<script type="text/javascript" src="http://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>

<script type="text/javascript">

    var pos;

    function locat(val){
        if(val === "Library"){
            pos = 1;
        }
        
        if(val === "Study Area"){
            pos = 2;
        }

        if(val === "Book Drop"){
            pos = 3;
        }

        if(val === "Exit"){
            pos = 4;
        }
    }

    const ros = new ROSLIB.Ros({url: "ws://localhost:9090"});

    ros.on("connection", () => {
        document.getElementById("status").innerHTML = "successful";
    });

    ros.on("error", (error) => {
        document.getElementById("status").innerHTML = `errored out (${error})`;
    });

    ros.on("close", () => {
        document.getElementById("status").innerHTML = "closed";
    });

    var topic_listener = new ROSLIB.Topic({
        ros,
        name: "/goal_number",
        messageType: "std_msgs/Int16"
    });

    var lib_count = 100;
    var study_count = 200;
    var book_count = 300;
    var exit_count = 400;
    setInterval(() => {
        locat();
        var msg;
        if(pos === 1){
            msg = lib_count;
        }

        if(pos === 2){
            msg = study_count;
        }

        if(pos === 3){
            msg = book_count;
        }

        if(pos === 4){
            msg = exit_count;
        }
        
        topic_listener.publish({data: msg});
        document.getElementById("messages").innerText = msg;
    }, 1000);


</script>

<h1 style="font-size: 60px; color:black;"> Where would you like to go?</h1>

<br>
<br>

<div class="rectangle"></div>

<br>
<br>

<div class="grid-container">
    <div class="grid-item">
        <input type="button" id="library" class="button" value="Library" onclick="locat(this.value);">
    </div>

    <div class="grid-item">
        <input type="button" id="library" class="button" value="Study Area" onclick="locat(this.value)">
    </div>

    <div class="grid-item">
        <input type="button" id="library" class="button" value="Book Drop" onclick="locat(this.value)">
    </div>

    <div class="grid-item">
        <input type="button" id="library" class="button" value="Exit" onclick="locat(this.value)">
    </div>
</div>

<br>
<br>

<div class="button-box col-lg-12 d-grid gap-1">
    <a href="{% url 'assist_home' %}" class="btn btn-primary" role="button" style="float: left;">Back</a>
</div>

<p>Connection: <span id="status" style="font-weight: bold;">N/A</span></p>
<p><code>/goal_number</code> messages received: <ul id="messages" style="font-weight: bold;"></ul></p>



{%endblock%}
